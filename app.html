<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
</head>
<body>
    <div class="main">
        <div class="title" id="title">
            <div class="logo">
            </div>
            <a class="download-btn" href="dianping://hynal.com">下载飞凡客户端</a>
        </div>
    </div>
    <script>
    var mobileAppInstall = (function() {
        var ua = navigator.userAgent,
            loadIframe, win = window;

        function getIntentIframe() {
            if (!loadIframe) {
                var iframe = document.createElement("iframe");
                iframe.style.cssText = "display:none;width:0px;height:0px;";
                document.body.appendChild(iframe);
                loadIframe = iframe;
            }
            return loadIframe;
        }

        function getChromeIntent(url) {
            return "intent://www.hynal.com/app.html#Intent;scheme=" + url + ";package=com.wanda.app.wanhui;end";
        }
        var appInstall = {
            isChrome: ua.match(/Chrome\/([\d.]+)/) || ua.match(/CriOS\/([\d.]+)/),
            isAndroid: ua.match(/(Android);?[\s\/]+([\d.]+)?/),
            timeout: 5000,
            /** * 尝试跳转appurl,如果跳转失败，进入h5url * @param {Object} appurl 应用地址 * @param {Object} h5url http地址 */
            open: function(appurl, h5url) {
                var t = Date.now();
                appInstall.openApp(appurl);
                setTimeout(function() {
                    if (Date.now() - t < appInstall.timeout + 100) {
                        h5url && appInstall.openH5(h5url);
                    }
                }, appInstall.timeout)
            },
            openApp: function(appurl) {
                if (appInstall.isChrome) {
                    if (appInstall.isAndroid) {
                        win.location.href = getChromeIntent(appurl);
                    } else {
                        win.location.href = appurl;
                    }
                } else {
                    getIntentIframe().src = appurl;
                }
            },
            openH5: function(h5url) {
                // win.location.href = h5url;
            }
        }
        return appInstall;
    })();
    console.log(mobileAppInstall);
    var downloadUrl = "http://a.app.qq.com/o/simple.jsp?pkgname=com.wanda.app.wanhui",
        schemeUrl = "wandafeifanapp://";
    //mobileAppInstall.open(schemeUrl, downloadUrl);
    </script>
</body>

</html>
